country_name="Afghanistan Aland Islands Albania Algeria American Samoa Andorra Angola Anguilla Antarctica Antigua and Barbuda Argentina Armenia Aruba Australia Austria Azerbaijan Bahamas Bahrain Bangladesh Barbados Belarus Belgium Belize Benin Bermuda Bhutan Bolivia, Plurinational State of Bonaire, Sint Eustatius and Saba Bosnia and Herzegovina Botswana Bouvet Island Brazil British Indian Ocean Territory Brunei Darussalam Bulgaria Burkina Faso Burundi Cambodia Cameroon Canada Cape Verde Cayman Islands Central African Republic Chad Chile China Christmas Island Cocos (Keeling) Islands Colombia Comoros Congo Congo, The Democratic Republic of the Cook Islands Costa Rica Cote D'ivoire Croatia Cuba Curacao Cyprus Czech Republic Denmark Djibouti Dominica Dominican Republic Ecuador Egypt El Salvador Equatorial Guinea Eritrea Estonia Ethiopia Falkland Islands (Malvinas) Faroe Islands Fiji Finland France French Guiana French Polynesia French Southern Territories Gabon Gambia Georgia Germany Ghana Gibraltar Greece Greenland Grenada Guadeloupe Guam Guatemala Guernsey Guinea Guinea-Bissau Guyana Haiti Heard Island and McDonald Islands Holy See (Vatican City State) Honduras Hong Kong Hungary Iceland India Indonesia Iran, Islamic Republic of Iraq Ireland Isle of Man Israel Italy Jamaica Japan Jersey Jordan Kazakhstan Kenya Kiribati Korea, Democratic People's Republic of Korea, Republic of Kuwait Kyrgyzstan Lao People's Democratic Republic Latvia Lebanon Lesotho Liberia Libyan Arab Jamahiriya Liechtenstein Lithuania Luxembourg Macao Macedonia, The Former Yugoslav Republic of Madagascar Malawi Malaysia Maldives Mali Malta Marshall Islands Martinique Mauritania Mauritius Mayotte Mexico Micronesia, Federated States of Moldova, Republic of Monaco Mongolia Montenegro Montserrat Morocco Mozambique Myanmar Namibia Nauru Nepal Netherlands New Caledonia New Zealand Nicaragua Niger Nigeria Niue Norfolk Island Northern Mariana Islands Norway Oman Pakistan Palau Palestinian Territory, Occupied Panama Papua New Guinea Paraguay Peru Philippines Pitcairn Poland Portugal Puerto Rico Qatar Reunion Romania Russian Federation Rwanda Saint Barthelemy Saint Helena, Ascension and Tristan Da Cunha Saint Kitts and Nevis Saint Lucia Saint Martin (French Part) Saint Pierre and Miquelon Saint Vincent and the Grenadines Samoa San Marino Sao Tome and Principe Saudi Arabia Senegal Serbia Seychelles Sierra Leone Singapore Sint Maarten (Dutch Part) Slovakia Slovenia Solomon Islands Somalia South Africa South Georgia and the South Sandwich Islands Spain Sri Lanka Sudan Suriname Svalbard and Jan Mayen Swaziland Sweden Switzerland Syrian Arab Republic Taiwan, Province of China Tajikistan Tanzania, United Republic of Thailand Timor-Leste Togo Tokelau Tonga Trinidad and Tobago Tunisia Turkey Turkmenistan Turks and Caicos Islands Tuvalu Uganda Ukraine United Arab Emirates United Kingdom United States United States Minor Outlying Islands Uruguay Uzbekistan Vanuatu Venezuela, Bolivarian Republic of Viet Nam Virgin Islands, British Virgin Islands, U.S. Wallis and Futuna Western Sahara Yemen Zambia Zimbabwe";countries=[{code:"AF",name:"Afghanistan"},{code:"AX",name:"Aland Islands"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia, Plurinational State of"},{code:"BQ",name:"Bonaire, Sint Eustatius and Saba"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"IO",name:"British Indian Ocean Territory"},{code:"BN",name:"Brunei Darussalam"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"CV",name:"Cape Verde"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CC",name:"Cocos (Keeling) Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo"},{code:"CD",name:"Congo, The Democratic Republic of the"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"CI",name:"Cote D'ivoire"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CW",name:"Curacao"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"DK",name:"Denmark"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands (Malvinas)"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GN",name:"Guinea"},{code:"GW",name:"Guinea-Bissau"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard Island and McDonald Islands"},{code:"VA",name:"Holy See (Vatican City State)"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran, Islamic Republic of"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KP",name:"Korea, Democratic People's Republic of"},{code:"KR",name:"Korea, Republic of"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Lao People's Democratic Republic"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libyan Arab Jamahiriya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macao"},{code:"MK",name:"Macedonia, The Former Yugoslav Republic of"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia, Federated States of"},{code:"MD",name:"Moldova, Republic of"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"NL",name:"Netherlands"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestinian Territory, Occupied"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RE",name:"Reunion"},{code:"RO",name:"Romania"},{code:"RU",name:"Russian Federation"},{code:"RW",name:"Rwanda"},{code:"BL",name:"Saint Barthelemy"},{code:"SH",name:"Saint Helena, Ascension and Tristan Da Cunha"},{code:"KN",name:"Saint Kitts and Nevis"},{code:"LC",name:"Saint Lucia"},{code:"MF",name:"Saint Martin (French Part)"},{code:"PM",name:"Saint Pierre and Miquelon"},{code:"VC",name:"Saint Vincent and the Grenadines"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"Sao Tome and Principe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SX",name:"Sint Maarten (Dutch Part)"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia and the South Sandwich Islands"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard and Jan Mayen"},{code:"SZ",name:"Swaziland"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syrian Arab Republic"},{code:"TW",name:"Taiwan, Province of China"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania, United Republic of"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad and Tobago"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks and Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States"},{code:"UM",name:"United States Minor Outlying Islands"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VE",name:"Venezuela, Bolivarian Republic of"},{code:"VN",name:"Viet Nam"},{code:"VG",name:"Virgin Islands, British"},{code:"VI",name:"Virgin Islands, U.S."},{code:"WF",name:"Wallis and Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"},];placeReference=null;scales=[{meters:100,zoom:19},{meters:250,zoom:18},{meters:500,zoom:17},{meters:1000,zoom:16},{meters:1750,zoom:15},{meters:2500,zoom:14},{meters:5000,zoom:13},{meters:10000,zoom:12},];function onLiClick(b){var a=$(b).find("span.name");if($(a).hasClass("checked")){$(a).removeClass("checked")}else{$(a).addClass("checked")}}function loadCountryNames(b){if(b==null){b="array"}else{b="string"}var a=[];$.each(countries,function(c,d){if(b=="string"){a=a+" "+d.name}else{a.push(d.name)}});return a}function getCountryCode(a){index=jQuery.inArray(a,loadCountryNames());if(index!=-1){return countries[index].code}else{return null}}function getCountryName(a){countryName=null;$.each(countries,function(b,c){if(c.code==a){countryName=c.name}});return countryName}$(document).ready(function(){$("span.btn.dropDownBtn").menuList({onLiClick:function(){onLiClick(this)},onNewList:function(m){$.ajax({type:"POST",url:url.modify_suggestion_list,data:{name:m},dataType:"json",success:function(n){$('<li id="listid-'+n.id+'"><span class="checkbox name" value="'+n.id+'">'+n.name+'</span> (<span class="list-'+n.id+'-counter">'+n.keys.length+"</span> "+gettext(sugerencias)+"</li>").insertBefore(".new-list-btn");$("#listid-"+n.id).click(function(){onLiClick(this)});$("#listid-"+n.id).click();$(".submenu li").not("li.new-list-btn").sortElements(function(p,o){return $(p).text().toLowerCase()>$(o).text().toLowerCase()?1:-1});$("#dropdown-list").removeClass("visible-display")}})}});var b=new Date();var g=FormatNumberLength(b.getMonth()+1,2);var j=FormatNumberLength(b.getDate(),2);var h=b.getFullYear();var i=g+"/"+j+"/"+h;$("#start-date,#end-date").attr("placeholder",i);var d=b.getMinutes();var k=b.getHours();var l=k;if(d>30){d="00";k=FormatNumberLength(k+1,2);l=l+1}else{if(d<30){d="30"}}var a=k+":"+d;var f=FormatNumberLength(l+1,2);var e=f+":"+d;$("#start-hour").attr("placeholder",a);$("#end-hour").attr("placeholder",e);$('#date [type="checkbox"]').attr("checked",true);$('input[disabled="true"]').css("background-color","#ddd");$(".date-type").datepicker();$("#start-date,#end-date").change(function(){var m=$("#start-date").val();var n=$("#end-date").val();if(!validateDates(m,n)){if($(this).attr("id")=="start-date"){$("#end-date").val(m)}else{$("#start-date").val(n)}}});$('#date [type="checkbox"]').change(function(){if($('#date [type="checkbox"]').is(":checked")==false){$('#date input:not([type="checkbox"])').attr("disabled",false);$('#date input:not([type="checkbox"])').css("background-color","#FFFFFF")}else{$('#date input:not([type="checkbox"])').attr("disabled",true);$('#date input:not([type="checkbox"])').css("background-color","#DDDDDD")}});$('#date [type="checkbox"]').parent().find("span").click(function(){$('#date [type="checkbox"]').click();$('#date [type="checkbox"]').change()});$("[placeholder]").placeholder();$("#add-details").toggle(function(){$("#description").slideDown("slow",function(){$("#add-details").addClass("used")})},function(){$("#description").slideUp("slow",function(){$("#add-details").removeClass("used")})});$("#add-tags").toggle(function(){$("#tags").slideDown("slow",function(){$("#add-tags").addClass("used")})},function(){$("#tags").slideUp("slow",function(){$("#add-tags").removeClass("used")})});$("#add-date").toggle(function(){$("#date").slideDown("slow",function(){$("#add-date").addClass("used")})},function(){$("#date").slideUp("slow",function(){$("#add-date").removeClass("used")})});$("#add-to-lists").toggle(function(){$("#lists").slideDown("slow",function(){$("#add-to-lists").addClass("used")})},function(){$("#lists").slideUp("slow",function(){$("#add-to-lists").removeClass("used")})});$("#visibility span").click(function(){var n=$(this).parent().find("span[value='private']");var m=$(this).parent().find("span[value='public']");if($(n).css("display")=="none"){$(n).show();m.hide();$("#social-share").fadeOut("slow")}else{$(n).hide();m.show();$("#social-share").fadeIn("slow")}});$("#social-share ul li span").click(function(){if($(this).hasClass("facebook-active")){$(this).removeClass("facebook-active").addClass("facebook-inactive");$(this).parent().addClass("inactive")}else{if($(this).hasClass("facebook-inactive")&&!$(this).hasClass("request-access")){$(this).removeClass("facebook-inactive").addClass("facebook-active");$(this).parent().removeClass("inactive")}else{if($(this).hasClass("twitter-active")){$(this).removeClass("twitter-active").addClass("twitter-inactive");$(this).parent().addClass("inactive")}else{if($(this).hasClass("twitter-inactive")&&!$(this).hasClass("request-access")){$(this).removeClass("twitter-inactive").addClass("twitter-active");$(this).parent().removeClass("inactive")}}}}});$(".request-access").each(function(m,n){if($(n).hasClass("twitter-inactive")){$(n).click(function(){$("#"+$(this).attr("id")+"-text").dialog("open")})}else{if($(n).hasClass("facebook-inactive")){$(n).click(function(){$("#"+$(this).attr("id")+"-text").dialog("open")})}}});setRemainingCharCounter("#id_name","#counter");$("#id_name").bind("keypress",function(m){if(m.keyCode==13){return false}});$("#address").geo_autocomplete(new google.maps.Geocoder,{mapkey:"ABQIAAAAr-AoA2f89U6keY8jwYAhgRSH1N1fcQdmTcucWBDBdqkgAa1-PhQhWKwe8ygo_Y3tFrHmB0jtJoQ0Bw",selectFirst:false,minChars:3,cacheLength:50,width:530,mapwidth:0,mapheight:0,scroll:true,scrollHeight:150,geocoder_region:"Spain",geocoder_types:"locality,street_address,sublocality,neighborhood,country",}).result(function(m,n){if(n){map.fitBounds(n.geometry.viewport)}});instanceMap();var c=[];for(k=0;k<24;k++){for(d=0;d<60;d=d+30){c.push(FormatNumberLength(k,2)+":"+FormatNumberLength(d,2))}}$("#start-hour").autocomplete({minLength:0,source:function(m,n){m.term="";n(c)}});$("#end-hour").autocomplete({minLength:0,source:function(n,o){var m=c.indexOf($("#start-hour").val());o(c.slice(m+1))}});$("#start-hour,#end-hour").focus(function(){$(this).autocomplete("search")});$("#start-hour,#end-hour").click(function(){$(this).autocomplete("search")})});function instanceMap(){if((typeof(default_marker_X)!="undefined")&&(typeof(default_marker_Y)!="undefined")){var b=[default_marker_X,default_marker_Y]}else{if(typeof eventID=="undefined"&&typeof(searchconfig_google.location)!=undefined){var b=searchconfig_google.location.split(",",2)}else{var b=eventLocation.split(",",2)}}var c=parseFloat(b[0]);var a=parseFloat(b[1]);loadGMaps(c,a,"map_canvas")}function loadCityField(a){$("#google-city").geo_autocomplete(new google.maps.Geocoder,{mapkey:"ABQIAAAAr-AoA2f89U6keY8jwYAhgRSH1N1fcQdmTcucWBDBdqkgAa1-PhQhWKwe8ygo_Y3tFrHmB0jtJoQ0Bw",selectFirst:false,minChars:3,cacheLength:50,width:340,mapwidth:0,mapheight:0,scroll:true,scrollHeight:150,geocoder_region:a,geocoder_types:"locality,sublocality",}).result(function(b,c){if(c){map.fitBounds(c.geometry.viewport)}})}function loadGoogleSettings(){$("input[name='place-type']:checked").removeAttr("checked");if(searchconfig_google.type=="establishment"){$($("input[name='place-type']")[0]).attr("checked","checked")}else{if(searchconfig_google.type=="geocode"){$($("input[name='place-type']")[1]).attr("checked","checked")}else{$($("input[name='place-type']")[2]).attr("checked","checked")}}$("input[name='place-type']").change();var a=searchconfig_google.location;var c=a.split(",",2);var d=parseFloat(c[0]);var b=parseFloat(c[1]);var e=new google.maps.LatLng(d,b);geocoder.geocode({latLng:e},function(g,f){if(f==google.maps.GeocoderStatus.OK){$.each(g,function(h,i){if(jQuery.inArray("locality",i.types)!=-1){$("#google-city").val(i.formatted_address)}})}else{alert("Geocoder failed due to: "+f)}});$("#google-city").change(function(){centerMap()});loadCityField($(this).val());$("#radius").change(function(){searchconfig_google.radius=$(this).val();resetMapZoom()})}function saveSettings(a){if(a=="google-places"){$("#savingSettings").text("Guardando...");geocoder.geocode({address:$("#google-city").val(),region:searchconfig_google.region_code},function(d,c){if(c==google.maps.GeocoderStatus.OK){var b=d[0].geometry.location.Ja+","+d[0].geometry.location.Ka;$.ajax({async:false,type:"POST",url:"/ajax/searchconfgoogle/",data:{type:$('input[name="place-type"]:checked').val(),radius:Number($("#radius").val()),location:b,},complete:function(e){if(e.status!=200){$("#answerMessage").removeClass("success");$("#answerMessage").addClass("error");$("#answerMessage").text(gettext("Ha habido un error al aÃ±adir la sugerencia, estamos trabajando para solucionarlo.")).fadeIn("slow").delay(2000).fadeOut("slow")}else{$("#answerMessage").removeClass("error");$("#answerMessage").addClass("success");$("#answerMessage").text(gettext("La sugerencia ha sido aÃ±adida con Ã©xito")).fadeIn("slow").delay(2000).fadeOut("slow");searchconfig_google.location=b;searchconfig_google.type=$('input[name="place-type"]:checked').val();searchconfig_google.radius=$("#radius").val();showSettings()}$("#savingSettings").text("Guardar")}})}else{alert("Geocode was not successful for the following reason: "+c)}})}}function centerMap(a,c){var b={};b.address=$("#google-city").val();b.region=searchconfig_google.region_code;geocoder.geocode(b,function(f,e){if(e==google.maps.GeocoderStatus.OK){var d=f[0].geometry.location.Ja+","+f[0].geometry.location.Ka;var g={Latlon:d,result:f[0]};map.fitBounds(f[0].geometry.viewport)}else{alert("Geocode was not successful for the following reason: "+e)}})}function loadGMaps(d,b,e){if((typeof(default_marker_X)!="undefined")&&(typeof(default_marker_Y)!="undefined")){d=default_marker_X;b=default_marker_Y}else{if(d==null||d==0){d=37.176}if(b==null||b==0){b=-3.597}}var c=searchconfig_google.radius;var f=11;$.each(scales,function(h,i){if(c<i.meters){f=i.zoom;return false}});var a={zoom:f,center:new google.maps.LatLng(d,b),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU,position:google.maps.ControlPosition.RIGHT_BOTTOM},scaleControl:true,scrollwheel:false,zoomControl:true,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE}};map=new google.maps.Map(document.getElementById(e),a);geocoder=new google.maps.Geocoder();insertToolbar(map);if((typeof(default_marker_X)!="undefined")&&(typeof(default_marker_Y)!="undefined")){var g=new google.maps.LatLng(default_marker_X,default_marker_Y);if(typeof(GRM.marker)=="undefined"){GRM.marker=createMarker(default_marker_X,default_marker_Y)}else{GRM.marker.setPosition(g)}}placesAutocomplete()}function autocompleteAddress(){$("#place").autocomplete({autoFocus:true,source:function(c,b){var d={};var a=new google.maps.places.PlacesService(map);d.location=new google.maps.LatLng(map.getCenter().lat(),map.getCenter().lng());d.radius=searchconfig_google.radius;d.key="AIzaSyBWrR-O_l5STwv1EO7U_Y3JNOnVjexf710";d.name=c.term;a.search(d,function(f,e){b($.map(f,function(g){return{label:g.name,value:g.name}}))})},select:function(b,c){var a=new google.maps.LatLng(c.item.latitude,c.item.longitude);map.setCenter(a)}})}function createMarker(a,e){var d=new google.maps.MarkerImage("/static/webapp/img/marcador02.png");var c=new google.maps.LatLng(a,e);var b=new google.maps.Marker({map:map,draggable:false,position:c,icon:d});b.setVisible(true);b.setDraggable(true);b.setAnimation(google.maps.Animation.DROP);google.maps.event.addListener(b,"dragend",function(){updateAddressByMarker(this)});return b}function codeLatLng(a){var c=a.split(",",2);var d=parseFloat(c[0]);var b=parseFloat(c[1]);var e=new google.maps.LatLng(d,b);geocoder.geocode({latLng:e},function(g,f){if(f==google.maps.GeocoderStatus.OK){if(g[1]){map.setZoom(11);marker=new google.maps.Marker({position:e,map:map});infowindow.setContent(g[1].formatted_address);infowindow.open(map,marker)}}else{alert("Geocoder failed due to: "+f)}})}function centerOnMyLocation(){var a;var b=new google.maps.LatLng(37.176,-3.597);var e=new Boolean();if(navigator.geolocation){e=true;navigator.geolocation.getCurrentPosition(function(f){a=new google.maps.LatLng(f.coords.latitude,f.coords.longitude);map.panTo(a)},function(){c(e)})}else{if(google.gears){e=true;var d=google.gears.factory.create("beta.geolocation");d.getCurrentPosition(function(f){a=new google.maps.LatLng(f.latitude,f.longitude);map.panTo(a)},function(){handleNoGeoLocation(e)})}else{e=false;c(e)}}function c(f){if(f==true){alert("Geolocation service failed.");a=b}else{alert("Your browser doesn't support geolocation. We've placed you in Granada.");a=b}map.panTo(a)}}function insertToolbar(c){var b=document.createElement("DIV");$(b).addClass("btnGmaps");$(b).attr("title","My location");$(b).html('<img src="/static/webapp/img/mirilla.png">');google.maps.event.addDomListener(b,"click",function(){centerOnMyLocation()});var a=document.createElement("DIV");$(a).css("padding","5px");$(a).append(b);c.controls[google.maps.ControlPosition.TOP_RIGHT].push(a)}function updateAddressByMarker(a){geocoder.geocode({latLng:a.getPosition()},function(c,b){if(b==google.maps.GeocoderStatus.OK){if(c&&c[0]){$("#address").val(c[0].formatted_address)}}})}function activateTab(a){if(a=="address"){$("#address-form").css("display","block");$("#place-form").css("display","none");$("#place-tab").removeClass("active");$("#address-tab").addClass("active")}else{$("#address-form").css("display","none");$("#place-form").css("display","block");$("#place-tab").addClass("active");$("#address-tab").removeClass("active")}}function saveSuggestion(){if($("#suggestion-item textarea").val()==$("#suggestion-item textarea").attr("placeholder")){showMessage("Por favor introduce primero la sugerencia","error");$("#suggestion-item textarea").focus();return false}if(placeReference==null){showMessage('Por favor indique el campo "Â¿Donde?" para continuar',"error");$("#place").focus();return false}if($('#date [type="checkbox"]').is(":checked")==false){if($("#start-date").val()!="mm/dd/aa"&&$("#end-date").val()!="mm/dd/aa"){var a=new Date($("#start-date").val());var d=new Date($("#end-date").val());if(a>d){showMessage("Por favor revise que la fecha de inicio sea anterior a la de fin","error");return false}else{if(a==d&&$("#start-hour").val()!="hh:mm"&&$("#end-hour").val()!="hh:mm"){var f=$("#start-hour").val().split(":");var c=$("#end-hour").val().split(":");if(f[0]>c[0]){showMessage("Por favor revise que la hora de inicio sea anterior a la de fin","error");return false}else{if(f[0]==c[0]){if(f[1]>c[1]){showMessage("Por favor revise que la hora de inicio sea anterior a la de fin","error");return false}}}}}}}$("#submit-button").text("Enviando...");$("#submit-button").addClass("waiting");GRM.wait();var e={name:$("#id_name").val(),place_reference:placeReference,description:($("#id_description").val()==$("#id_description").attr("placeholder"))?"":$("#id_description").val(),visibility:$("#id_visibility").val(),tags:$("#id_tags").val()};if($('#date [type="checkbox"]').is(":checked")==false){tmp=$('#date [type="checkbox"]');splittedDate=$("#start-date").val().split("/");e.starts_month=splittedDate[0];e.starts_day=splittedDate[1];e.starts_year=splittedDate[2];e.starts_hour=$("#start-hour").val();splittedDate=$("#end-date").val().split("/");e.ends_month=splittedDate[0];e.ends_day=splittedDate[1];e.ends_year=splittedDate[2];e.ends_hour=$("#end-hour").val()}if($('#visibility span[value="public"]').css("display")!="none"){e.visibility="public"}else{e.visibility="private"}if($("#lists span.checked").length>0){e.list_id="";$("#lists span.checked").each(function(g,h){e.list_id=$(h).attr("value")+","+e.list_id})}var b=$("#social-share ul li:not(.inactive)");if(b.length>0){$(b).each(function(g,h){e["to_"+$(h).attr("data-network")]=true})}if(typeof eventID!="undefined"){e.eventid=eventID}$.ajax({type:"POST",url:"/ajax/add/suggestion/",data:jQuery.param(e),complete:function(g){GRM.nowait();if(g.status!=200){showMessage("Error "+g.status,"error")}else{showMessage("La sugerencia ha sido aÃ±adida con Ã©xito","success");$("#id_name").val("").blur();$("#id_description").val("");$("#id_tags").val("");$("#place").val("").blur();$("#lists span.checked").each(function(h,j){$(j).removeClass("checked")});instanceMap()}$("#submit-button").text("Enviar");$("#submit-button").removeClass("waiting")}});return false}function showSettings(){loadGoogleSettings();$("input[name='engine']").each(function(){a=$(this).val();if(a!=$("input[name='engine']:checked").val()){if($("#"+a+"-settings").css("display")=="block"){$("#"+a+"-settings").fadeOut("slow")}}});var a=$("input[name='engine']:checked").val();$("#"+a+"-settings").toggle("slow",function(){resizeIframe()})}function placesAutocomplete(){var b=document.getElementById("place");var c={region:searchconfig_google.region_code};if(searchconfig_google.type!="all"){c.types=[searchconfig_google.type]}autocomplete=new google.maps.places.Autocomplete(b,c);autocomplete.bindTo("bounds",map);var d=new google.maps.InfoWindow();var a=new google.maps.Marker({map:map});google.maps.event.addListener(autocomplete,"place_changed",function(){d.close();var f=autocomplete.getPlace();if(f.geometry.viewport){map.fitBounds(f.geometry.viewport)}else{map.setCenter(f.geometry.location);map.setZoom(17)}placeReference=f.reference;var g=new google.maps.MarkerImage("/static/webapp/img/marcador03.png",new google.maps.Size(71,71),new google.maps.Point(0,0),new google.maps.Point(17,34),new google.maps.Size(35,35));a.setIcon(g);a.setPosition(f.geometry.location);var e="";if(f.address_components){e=[(f.address_components[0]&&f.address_components[0].short_name||""),(f.address_components[1]&&f.address_components[1].short_name||""),(f.address_components[2]&&f.address_components[2].short_name||"")].join(" ")}a.setIcon(g);a.setPosition(f.geometry.location);d.setContent("<div><strong>"+f.name+"</strong><br>"+e);d.open(map,a)})}function getEventPlace(){var c=eventLocation.split(",",2);var a=new google.maps.LatLng(c[0],c[1]);var b={reference:poi_reference,location:a,radius:"50",};service=new google.maps.places.PlacesService(map);service.search(b,function d(h,f){if(f==google.maps.places.PlacesServiceStatus.OK){for(var g=0;g<h.length;g++){var e=h[g]}}})}function resetMapZoom(c){var a=searchconfig_google.radius;var b=11;if(c){a=c}$.each(scales,function(d,e){if(a<e.meters){b=e.zoom;map.setZoom(e.zoom);return false}});return b}function showMoreDetails(){$("#more-details").toggle("fast",function(){resizeIframe()})}(function(a){a.fn.extend({geoautocomplete:function(b,c){var d=typeof b=="string";c=a.extend({},a.GeoAutocompleter.defaults,{url:d?b:null,data:d?null:b,delay:d?a.GeoAutocompleter.defaults.delay:10,max:c&&!c.scroll?10:150},c);c.highlight=c.highlight||function(e){return e};c.formatMatch=c.formatMatch||c.formatItem;return this.each(function(){new a.GeoAutocompleter(this,c)})},result:function(b){return this.bind("result",b)},search:function(b){return this.trigger("search",[b])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(b){return this.trigger("setOptions",[b])},unautocomplete:function(){return this.trigger("unautocomplete")}});a.GeoAutocompleter=function(l,g){var c={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8};var b=a(l).attr("autocomplete","off").addClass(g.inputClass);var j;var p="";var m=a.GeoAutocompleter.Cache(g);var e=0;var u;var x={mouseDownOnSelect:false};var r=a.GeoAutocompleter.Select(g,l,d,x);var w;a.browser.opera&&a(l.form).bind("submit.autocomplete",function(){if(w){w=false;return false}});b.bind((a.browser.opera?"keypress":"keydown")+".autocomplete",function(y){e=1;u=y.keyCode;switch(y.keyCode){case c.UP:y.preventDefault();if(r.visible()){r.prev()}else{t(0,true)}break;case c.DOWN:y.preventDefault();if(r.visible()){r.next()}else{t(0,true)}break;case c.PAGEUP:y.preventDefault();if(r.visible()){r.pageUp()}else{t(0,true)}break;case c.PAGEDOWN:y.preventDefault();if(r.visible()){r.pageDown()}else{t(0,true)}break;case g.multiple&&a.trim(g.multipleSeparator)==","&&c.COMMA:case c.TAB:case c.RETURN:if(d()){y.preventDefault();w=true;return false}break;case c.ESC:r.hide();break;default:clearTimeout(j);j=setTimeout(t,g.delay);break}}).focus(function(){e++}).blur(function(){e=0;if(!x.mouseDownOnSelect){s()}}).click(function(){if(e++>1&&!r.visible()){t(0,true)}}).bind("search",function(){var y=(arguments.length>1)?arguments[1]:null;function z(D,C){var A;if(C&&C.length){for(var B=0;B<C.length;B++){if(C[B].result.toLowerCase()==D.toLowerCase()){A=C[B];break}}}if(typeof y=="function"){y(A)}else{b.trigger("result",A&&[A.data,A.value])}}a.each(h(b.val()),function(A,B){f(B,z,z)})}).bind("flushCache",function(){m.flush()}).bind("setOptions",function(){a.extend(g,arguments[1]);if("data" in arguments[1]){m.populate()}}).bind("unautocomplete",function(){r.unbind();b.unbind();a(l.form).unbind(".autocomplete")});function d(){var B=r.selected();if(!B){return false}var y=B.result;p=y;if(g.multiple){var E=h(b.val());if(E.length>1){var A=g.multipleSeparator.length;var D=a(l).selection().start;var C,z=0;a.each(E,function(F,G){z+=G.length;if(D<=z){C=F;return false}z+=A});E[C]=y;y=E.join(g.multipleSeparator)}y+=g.multipleSeparator}b.val(y);v();b.trigger("result",[B.data,B.value]);return true}function t(A,z){if(u==c.DEL){r.hide();return}var y=b.val();if(!z&&y==p){return}p=y;y=i(y);if(y.length>=g.minChars){b.addClass(g.loadingClass);if(!g.matchCase){y=y.toLowerCase()}f(y,k,v)}else{n();r.hide()}}function h(y){if(!y){return[""]}if(!g.multiple){return[a.trim(y)]}return a.map(y.split(g.multipleSeparator),function(z){return a.trim(y).length?a.trim(z):null})}function i(y){if(!g.multiple){return y}var A=h(y);if(A.length==1){return A[0]}var z=a(l).selection().start;if(z==y.length){A=h(y)}else{A=h(y.replace(y.substring(z),""))}return A[A.length-1]}function q(y,z){if(g.autoFill&&(i(b.val()).toLowerCase()==y.toLowerCase())&&u!=c.BACKSPACE){b.val(b.val()+z.substring(i(p).length));a(l).selection(p.length,p.length+z.length)}}function s(){clearTimeout(j);j=setTimeout(v,200)}function v(){var y=r.visible();r.hide();clearTimeout(j);n();if(g.mustMatch){b.search(function(z){if(!z){if(g.multiple){var A=h(b.val()).slice(0,-1);b.val(A.join(g.multipleSeparator)+(A.length?g.multipleSeparator:""))}else{b.val("");b.trigger("result",null)}}})}}function k(z,y){if(y&&y.length&&e){n();r.display(y,z);q(z,y[0].value);r.show()}else{v()}}function f(A,C,z){if(!g.matchCase){A=A.toLowerCase()}var B=m.load(A);if(B&&B.length){C(A,B)}else{if(g.geocoder){var y=i(A);g.geocoder.geocode({address:y},function(E,G){var F=g.parse(E,G,y);m.add(A,F);C(A,F)})}else{if((typeof g.url=="string")&&(g.url.length>0)){var D={timestamp:+new Date()};a.each(g.extraParams,function(E,F){D[E]=typeof F=="function"?F():F});a.ajax({mode:"abort",port:"autocomplete"+l.name,dataType:g.dataType,url:g.url,data:a.extend({q:i(A),limit:g.max},D),success:function(F){var E=g.parse&&g.parse(F)||o(F);m.add(A,E);C(A,E)}})}else{r.emptyList();z(A)}}}}function o(B){var y=[];var A=B.split("\n");for(var z=0;z<A.length;z++){var C=a.trim(A[z]);if(C){C=C.split("|");y[y.length]={data:C,value:C[0],result:g.formatResult&&g.formatResult(C,C[0])||C[0]}}}return y}function n(){b.removeClass(g.loadingClass)}};a.GeoAutocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(b){return b[0]},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(c,b){return c.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:true,scrollHeight:180};a.GeoAutocompleter.Cache=function(c){var f={};var d=0;function h(l,k){if(!c.matchCase){l=l.toLowerCase()}var j=l.indexOf(k);if(c.matchContains=="word"){j=l.toLowerCase().search("\\b"+k.toLowerCase())}if(j==-1){return false}return j==0||c.matchContains}function g(j,i){if(d>c.cacheLength){b()}if(!f[j]){d++}f[j]=i}function e(){if(!c.data){return false}var k={},j=0;if(!c.url){c.cacheLength=1}k[""]=[];for(var m=0,l=c.data.length;m<l;m++){var p=c.data[m];p=(typeof p=="string")?[p]:p;var o=c.formatMatch(p,m+1,c.data.length);if(o===false){continue}var n=o.charAt(0).toLowerCase();if(!k[n]){k[n]=[]}var q={value:o,data:p,result:c.formatResult&&c.formatResult(p)||o};k[n].push(q);if(j++<c.max){k[""].push(q)}}a.each(k,function(r,s){c.cacheLength++;g(r,s)})}setTimeout(e,25);function b(){f={};d=0}return{flush:b,add:g,populate:e,load:function(n){if(!c.cacheLength||!d){return null}if(!c.url&&c.matchContains){var m=[];for(var j in f){if(j.length>0){var o=f[j];a.each(o,function(p,k){if(h(k.value,n)){m.push(k)}})}}return m}else{if(f[n]){return f[n]}else{if(c.matchSubset){for(var l=n.length-1;l>=c.minChars;l--){var o=f[n.substr(0,l)];if(o){var m=[];a.each(o,function(p,k){if(h(k.value,n)){m[m.length]=k}});return m}}}}}return null}}};a.GeoAutocompleter.Select=function(e,j,l,p){var i={ACTIVE:"ac_over"};var k,f=-1,r,m="",s=true,c,o;function n(){if(!s){return}c=a("<div/>").hide().addClass(e.resultsClass).css("position","absolute").appendTo(document.body);o=a("<ul/>").appendTo(c).mouseover(function(t){if(q(t).nodeName&&q(t).nodeName.toUpperCase()=="LI"){f=a("li",o).removeClass(i.ACTIVE).index(q(t));a(q(t)).addClass(i.ACTIVE)}}).click(function(t){a(q(t)).addClass(i.ACTIVE);l();j.focus();return false}).mousedown(function(){p.mouseDownOnSelect=true}).mouseup(function(){p.mouseDownOnSelect=false});if(e.width>0){c.css("width",e.width)}s=false}function q(u){var t=u.target;while(t&&t.tagName!="LI"){t=t.parentNode}if(!t){return[]}return t}function h(t){k.slice(f,f+1).removeClass(i.ACTIVE);g(t);var v=k.slice(f,f+1).addClass(i.ACTIVE);if(e.scroll){var u=0;k.slice(0,f).each(function(){u+=this.offsetHeight});if((u+v[0].offsetHeight-o.scrollTop())>o[0].clientHeight){o.scrollTop(u+v[0].offsetHeight-o.innerHeight())}else{if(u<o.scrollTop()){o.scrollTop(u)}}}}function g(t){f+=t;if(f<0){f=k.size()-1}else{if(f>=k.size()){f=0}}}function b(t){return e.max&&e.max<t?e.max:t}function d(){o.empty();var u=b(r.length);for(var v=0;v<u;v++){if(!r[v]){continue}var w=e.formatItem(r[v].data,v+1,u,r[v].value,m);if(w===false){continue}var t=a("<li/>").html(e.highlight(w,m)).addClass(v%2==0?"ac_even":"ac_odd").appendTo(o)[0];a.data(t,"ac_data",r[v])}k=o.find("li");if(e.selectFirst){k.slice(0,1).addClass(i.ACTIVE);f=0}if(a.fn.bgiframe){o.bgiframe()}}return{display:function(u,t){n();r=u;m=t;d()},next:function(){h(1)},prev:function(){h(-1)},pageUp:function(){if(f!=0&&f-8<0){h(-f)}else{h(-8)}},pageDown:function(){if(f!=k.size()-1&&f+8>k.size()){h(k.size()-1-f)}else{h(8)}},hide:function(){c&&c.hide();k&&k.removeClass(i.ACTIVE);f=-1},visible:function(){return c&&c.is(":visible")},current:function(){return this.visible()&&(k.filter("."+i.ACTIVE)[0]||e.selectFirst&&k[0])},show:function(){var v=a(j).offset();c.css({width:typeof e.width=="string"||e.width>0?e.width:a(j).width(),top:v.top+j.offsetHeight,left:v.left}).show();if(e.scroll){o.scrollTop(0);o.css({maxHeight:e.scrollHeight,overflow:"auto"});if(a.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var t=0;k.each(function(){t+=this.offsetHeight});var u=t>e.scrollHeight;o.css("height",u?e.scrollHeight:t);if(!u){k.width(o.width()-parseInt(k.css("padding-left"))-parseInt(k.css("padding-right")))}}}},selected:function(){var t=k&&k.filter("."+i.ACTIVE).removeClass(i.ACTIVE);return t&&t.length&&a.data(t[0],"ac_data")},emptyList:function(){o&&o.empty()},unbind:function(){c&&c.remove()}}};a.fn.selection=function(i,b){if(i!==undefined){return this.each(function(){if(this.createTextRange){var j=this.createTextRange();if(b===undefined||i==b){j.move("character",i);j.select()}else{j.collapse(true);j.moveStart("character",i);j.moveEnd("character",b);j.select()}}else{if(this.setSelectionRange){this.setSelectionRange(i,b)}else{if(this.selectionStart){this.selectionStart=i;this.selectionEnd=b}}}})}var g=this[0];if(g.createTextRange){var c=document.selection.createRange(),h=g.value,f="<->",d=c.text.length;c.text=f;var e=g.value.indexOf(f);g.value=h;this.selection(e,e+d);return{start:e,end:e+d}}else{if(g.selectionStart!==undefined){return{start:g.selectionStart,end:g.selectionEnd}}}}})(jQuery);(function(a){a.fn.extend({geo_autocomplete:function(c,b){options=a.extend({},a.GeoAutocompleter.defaults,{geocoder:c,mapwidth:100,mapheight:100,maptype:"terrain",mapkey:"ABQIAAAAbnvDoAoYOSW2iqoXiGTpYBT2yXp_ZAY8_ufC3CFXhHIE1NvwkxQNumU68AwGqjbSNF9YO8NokKst8w",mapsensor:false,parse:function(d,f,e){var g=[];if(d&&f&&f=="OK"){a.each(d,function(j,i){if(i.geometry&&i.geometry.viewport){var h=i.formatted_address.split(",");var k=h[0];a.each(h,function(m,l){if(l.toLowerCase().indexOf(e.toLowerCase())!=-1){k=a.trim(l);return false}});g.push({data:i,value:k,result:k})}})}return g},formatItem:function(f,h,e,d){var i="http://maps.google.com/maps/api/staticmap?visible="+f.geometry.viewport.getSouthWest().toUrlValue()+"|"+f.geometry.viewport.getNorthEast().toUrlValue()+"&size="+options.mapwidth+"x"+options.mapheight+"&maptype="+options.maptype+"&key="+options.mapkey+"&sensor="+(options.mapsensor?"true":"false");var g=f.formatted_address.replace(/,/gi,",<br/>");return'<img src="'+i+'" width="'+options.mapwidth+'" height="'+options.mapheight+'" /> '+g+'<br clear="both"/>'}},b);options.highlight=options.highlight||function(d){return d};options.formatMatch=options.formatMatch||options.formatItem;return this.each(function(){new a.GeoAutocompleter(this,options)})}})})(jQuery);(function(a){a.fn.extend({autocomplete:function(b,c){var d=typeof b=="string";c=a.extend({},a.Autocompleter.defaults,{url:d?b:null,data:d?null:b,delay:d?a.Autocompleter.defaults.delay:10,max:c&&!c.scroll?10:150},c);c.highlight=c.highlight||function(e){return e};c.formatMatch=c.formatMatch||c.formatItem;return this.each(function(){new a.Autocompleter(this,c)})},result:function(b){return this.bind("result",b)},search:function(b){return this.trigger("search",[b])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(b){return this.trigger("setOptions",[b])},unautocomplete:function(){return this.trigger("unautocomplete")}});a.Autocompleter=function(l,g){var c={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8};var b=a(l).attr("autocomplete","off").addClass(g.inputClass);var j;var p="";var m=a.Autocompleter.Cache(g);var e=0;var u;var x={mouseDownOnSelect:false};var r=a.Autocompleter.Select(g,l,d,x);var w;a.browser.opera&&a(l.form).bind("submit.autocomplete",function(){if(w){w=false;return false}});b.bind((a.browser.opera?"keypress":"keydown")+".autocomplete",function(y){e=1;u=y.keyCode;switch(y.keyCode){case c.UP:y.preventDefault();if(r.visible()){r.prev()}else{t(0,true)}break;case c.DOWN:y.preventDefault();if(r.visible()){r.next()}else{t(0,true)}break;case c.PAGEUP:y.preventDefault();if(r.visible()){r.pageUp()}else{t(0,true)}break;case c.PAGEDOWN:y.preventDefault();if(r.visible()){r.pageDown()}else{t(0,true)}break;case g.multiple&&a.trim(g.multipleSeparator)==","&&c.COMMA:case c.TAB:case c.RETURN:if(d()){y.preventDefault();w=true;return false}break;case c.ESC:r.hide();break;default:clearTimeout(j);j=setTimeout(t,g.delay);break}}).focus(function(){e++}).blur(function(){e=0;if(!x.mouseDownOnSelect){s()}}).click(function(){if(e++>1&&!r.visible()){t(0,true)}}).bind("search",function(){var y=(arguments.length>1)?arguments[1]:null;function z(D,C){var A;if(C&&C.length){for(var B=0;B<C.length;B++){if(C[B].result.toLowerCase()==D.toLowerCase()){A=C[B];break}}}if(typeof y=="function"){y(A)}else{b.trigger("result",A&&[A.data,A.value])}}a.each(h(b.val()),function(A,B){f(B,z,z)})}).bind("flushCache",function(){m.flush()}).bind("setOptions",function(){a.extend(g,arguments[1]);if("data" in arguments[1]){m.populate()}}).bind("unautocomplete",function(){r.unbind();b.unbind();a(l.form).unbind(".autocomplete")});function d(){var B=r.selected();if(!B){return false}var y=B.result;p=y;if(g.multiple){var E=h(b.val());if(E.length>1){var A=g.multipleSeparator.length;var D=a(l).selection().start;var C,z=0;a.each(E,function(F,G){z+=G.length;if(D<=z){C=F;return false}z+=A});E[C]=y;y=E.join(g.multipleSeparator)}y+=g.multipleSeparator}b.val(y);v();b.trigger("result",[B.data,B.value]);return true}function t(A,z){if(u==c.DEL){r.hide();return}var y=b.val();if(!z&&y==p){return}p=y;y=i(y);if(y.length>=g.minChars){b.addClass(g.loadingClass);if(!g.matchCase){y=y.toLowerCase()}f(y,k,v)}else{n();r.hide()}}function h(y){if(!y){return[""]}if(!g.multiple){return[a.trim(y)]}return a.map(y.split(g.multipleSeparator),function(z){return a.trim(y).length?a.trim(z):null})}function i(y){if(!g.multiple){return y}var A=h(y);if(A.length==1){return A[0]}var z=a(l).selection().start;if(z==y.length){A=h(y)}else{A=h(y.replace(y.substring(z),""))}return A[A.length-1]}function q(y,z){if(g.autoFill&&(i(b.val()).toLowerCase()==y.toLowerCase())&&u!=c.BACKSPACE){b.val(b.val()+z.substring(i(p).length));a(l).selection(p.length,p.length+z.length)}}function s(){clearTimeout(j);j=setTimeout(v,200)}function v(){var y=r.visible();r.hide();clearTimeout(j);n();if(g.mustMatch){b.search(function(z){if(!z){if(g.multiple){var A=h(b.val()).slice(0,-1);b.val(A.join(g.multipleSeparator)+(A.length?g.multipleSeparator:""))}else{b.val("");b.trigger("result",null)}}})}}function k(z,y){if(y&&y.length&&e){n();r.display(y,z);q(z,y[0].value);r.show()}else{v()}}function f(A,C,z){if(!g.matchCase){A=A.toLowerCase()}var B=m.load(A);if(B&&B.length){C(A,B)}else{if(g.geocoder){var y=i(A);g.geocoder.geocode({address:y},function(E,G){var F=g.parse(E,G,y);m.add(A,F);C(A,F)})}else{if((typeof g.url=="string")&&(g.url.length>0)){var D={timestamp:+new Date()};a.each(g.extraParams,function(E,F){D[E]=typeof F=="function"?F():F});a.ajax({mode:"abort",port:"autocomplete"+l.name,dataType:g.dataType,url:g.url,data:a.extend({q:i(A),limit:g.max},D),success:function(F){var E=g.parse&&g.parse(F)||o(F);m.add(A,E);C(A,E)}})}else{r.emptyList();z(A)}}}}function o(B){var y=[];var A=B.split("\n");for(var z=0;z<A.length;z++){var C=a.trim(A[z]);if(C){C=C.split("|");y[y.length]={data:C,value:C[0],result:g.formatResult&&g.formatResult(C,C[0])||C[0]}}}return y}function n(){b.removeClass(g.loadingClass)}};a.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(b){return b[0]},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(c,b){return c.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:true,scrollHeight:180};a.Autocompleter.Cache=function(c){var f={};var d=0;function h(l,k){if(!c.matchCase){l=l.toLowerCase()}var j=l.indexOf(k);if(c.matchContains=="word"){j=l.toLowerCase().search("\\b"+k.toLowerCase())}if(j==-1){return false}return j==0||c.matchContains}function g(j,i){if(d>c.cacheLength){b()}if(!f[j]){d++}f[j]=i}function e(){if(!c.data){return false}var k={},j=0;if(!c.url){c.cacheLength=1}k[""]=[];for(var m=0,l=c.data.length;m<l;m++){var p=c.data[m];p=(typeof p=="string")?[p]:p;var o=c.formatMatch(p,m+1,c.data.length);if(o===false){continue}var n=o.charAt(0).toLowerCase();if(!k[n]){k[n]=[]}var q={value:o,data:p,result:c.formatResult&&c.formatResult(p)||o};k[n].push(q);if(j++<c.max){k[""].push(q)}}a.each(k,function(r,s){c.cacheLength++;g(r,s)})}setTimeout(e,25);function b(){f={};d=0}return{flush:b,add:g,populate:e,load:function(n){if(!c.cacheLength||!d){return null}if(!c.url&&c.matchContains){var m=[];for(var j in f){if(j.length>0){var o=f[j];a.each(o,function(p,k){if(h(k.value,n)){m.push(k)}})}}return m}else{if(f[n]){return f[n]}else{if(c.matchSubset){for(var l=n.length-1;l>=c.minChars;l--){var o=f[n.substr(0,l)];if(o){var m=[];a.each(o,function(p,k){if(h(k.value,n)){m[m.length]=k}});return m}}}}}return null}}};a.Autocompleter.Select=function(e,j,l,p){var i={ACTIVE:"ac_over"};var k,f=-1,r,m="",s=true,c,o;function n(){if(!s){return}c=a("<div/>").hide().addClass(e.resultsClass).css("position","absolute").appendTo(document.body);o=a("<ul/>").appendTo(c).mouseover(function(t){if(q(t).nodeName&&q(t).nodeName.toUpperCase()=="LI"){f=a("li",o).removeClass(i.ACTIVE).index(q(t));a(q(t)).addClass(i.ACTIVE)}}).click(function(t){a(q(t)).addClass(i.ACTIVE);l();j.focus();return false}).mousedown(function(){p.mouseDownOnSelect=true}).mouseup(function(){p.mouseDownOnSelect=false});if(e.width>0){c.css("width",e.width)}s=false}function q(u){var t=u.target;while(t&&t.tagName!="LI"){t=t.parentNode}if(!t){return[]}return t}function h(t){k.slice(f,f+1).removeClass(i.ACTIVE);g(t);var v=k.slice(f,f+1).addClass(i.ACTIVE);if(e.scroll){var u=0;k.slice(0,f).each(function(){u+=this.offsetHeight});if((u+v[0].offsetHeight-o.scrollTop())>o[0].clientHeight){o.scrollTop(u+v[0].offsetHeight-o.innerHeight())}else{if(u<o.scrollTop()){o.scrollTop(u)}}}}function g(t){f+=t;if(f<0){f=k.size()-1}else{if(f>=k.size()){f=0}}}function b(t){return e.max&&e.max<t?e.max:t}function d(){o.empty();var u=b(r.length);for(var v=0;v<u;v++){if(!r[v]){continue}var w=e.formatItem(r[v].data,v+1,u,r[v].value,m);if(w===false){continue}var t=a("<li/>").html(e.highlight(w,m)).addClass(v%2==0?"ac_even":"ac_odd").appendTo(o)[0];a.data(t,"ac_data",r[v])}k=o.find("li");if(e.selectFirst){k.slice(0,1).addClass(i.ACTIVE);f=0}if(a.fn.bgiframe){o.bgiframe()}}return{display:function(u,t){n();r=u;m=t;d()},next:function(){h(1)},prev:function(){h(-1)},pageUp:function(){if(f!=0&&f-8<0){h(-f)}else{h(-8)}},pageDown:function(){if(f!=k.size()-1&&f+8>k.size()){h(k.size()-1-f)}else{h(8)}},hide:function(){c&&c.hide();k&&k.removeClass(i.ACTIVE);f=-1},visible:function(){return c&&c.is(":visible")},current:function(){return this.visible()&&(k.filter("."+i.ACTIVE)[0]||e.selectFirst&&k[0])},show:function(){var v=a(j).offset();c.css({width:typeof e.width=="string"||e.width>0?e.width:a(j).width(),top:v.top+j.offsetHeight,left:v.left}).show();if(e.scroll){o.scrollTop(0);o.css({maxHeight:e.scrollHeight,overflow:"auto"});if(a.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var t=0;k.each(function(){t+=this.offsetHeight});var u=t>e.scrollHeight;o.css("height",u?e.scrollHeight:t);if(!u){k.width(o.width()-parseInt(k.css("padding-left"))-parseInt(k.css("padding-right")))}}}},selected:function(){var t=k&&k.filter("."+i.ACTIVE).removeClass(i.ACTIVE);return t&&t.length&&a.data(t[0],"ac_data")},emptyList:function(){o&&o.empty()},unbind:function(){c&&c.remove()}}};a.fn.selection=function(i,b){if(i!==undefined){return this.each(function(){if(this.createTextRange){var j=this.createTextRange();if(b===undefined||i==b){j.move("character",i);j.select()}else{j.collapse(true);j.moveStart("character",i);j.moveEnd("character",b);j.select()}}else{if(this.setSelectionRange){this.setSelectionRange(i,b)}else{if(this.selectionStart){this.selectionStart=i;this.selectionEnd=b}}}})}var g=this[0];if(g.createTextRange){var c=document.selection.createRange(),h=g.value,f="<->",d=c.text.length;c.text=f;var e=g.value.indexOf(f);g.value=h;this.selection(e,e+d);return{start:e,end:e+d}}else{if(g.selectionStart!==undefined){return{start:g.selectionStart,end:g.selectionEnd}}}}})(jQuery);(function(a){a.fn.extend({geo_autocomplete:function(c,b){options=a.extend({},a.Autocompleter.defaults,{geocoder:c,mapwidth:100,mapheight:100,maptype:"terrain",mapkey:"ABQIAAAAbnvDoAoYOSW2iqoXiGTpYBT2yXp_ZAY8_ufC3CFXhHIE1NvwkxQNumU68AwGqjbSNF9YO8NokKst8w",mapsensor:false,parse:function(d,f,e){var g=[];if(d&&f&&f=="OK"){a.each(d,function(j,i){if(i.geometry&&i.geometry.viewport){var h=i.formatted_address.split(",");var k=h[0];a.each(h,function(m,l){if(l.toLowerCase().indexOf(e.toLowerCase())!=-1){k=a.trim(l);return false}});g.push({data:i,value:k,result:k})}})}return g},formatItem:function(f,h,e,d){var i="http://maps.google.com/maps/api/staticmap?visible="+f.geometry.viewport.getSouthWest().toUrlValue()+"|"+f.geometry.viewport.getNorthEast().toUrlValue()+"&size="+options.mapwidth+"x"+options.mapheight+"&maptype="+options.maptype+"&key="+options.mapkey+"&sensor="+(options.mapsensor?"true":"false");var g=f.formatted_address.replace(/,/gi,",<br/>");return'<img src="'+i+'" width="'+options.mapwidth+'" height="'+options.mapheight+'" /> '+g+'<br clear="both"/>'}},b);options.highlight=options.highlight||function(d){return d};options.formatMatch=options.formatMatch||options.formatItem;return this.each(function(){new a.Autocompleter(this,options)})}})})(jQuery);