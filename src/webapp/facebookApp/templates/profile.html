{% extends "base.html" %}

{% block title %}Perfil público de {{profile.username}}{% endblock %}
{% block extra_js %}
    <script src="/static/webapp/js/jquery.tmpl.min.js"></script>
    <script src="/static/facebookApp/js/grm.js"></script>
    <script src="/static/facebookApp/js/social.js"></script>
    <script type="text/javascript">
    
    $("#user-avatar").ready(function(){
        $(this).load();
    });
    $(document).ready(function(){
        
        //Adding behaviour to tab content
        $('#tabMenu li').click(function(){
            tab_id=$('#tabMenu li.active').attr('id')
            $('#'+tab_id+'_content').addClass('hidden');
            $('#tabMenu li.active').removeClass('active');
            
            tab_id=$(this).attr('id')
            $('#'+tab_id+'_content').removeClass('hidden');
            $(this).addClass('active');
        })
    });
    </script>
{%endblock%}

{% block body %}
    <div id="public-profile">
        <div id="col-right-left">
            <span id="avatar-follow">
                <img id="user-avatar" src="/user/{{profile.username}}/picture/" alt="{{profile.username}} avatar"/>
                <br>
                {% ifnotequal user.username profile.parent.username %}
                    {% if is_follower %}
                        <div id="following_state_{{ profile.parent.id }}" class="follow-button following-state">
                            <span  onclick="javascript:follow('unfollow',{{profile.parent.id}})"><a href="#" class="following">Seguiendo</a></span>
                        </div>
                    {% else %}
                        <div id="following_state_{{ profile.parent.id }}" class="follow-button">
                            <span  onclick="javascript:follow('follow',{{profile.parent.id}})"><a href="#" class="no-following">Seguir</a></span>
                        </div>
                    {% endif %}
                {% endifnotequal %}
            </span>
            <h1>{{profile.parent.username}}</h1>
            {% ifequal user.username profile.parent.username %}
                <a href="/fb/user/edit/" class="rounded-button" id="edit-profile-btn">Editar</a> 
            {% endifequal %}
            {% if profile.description %}
                <p>{{profile.description}}</p>
            {% endif %}
        
            
            
        </div>
        <div id="col-right-right">
            <p>
                <a href="/fb/user/{{profile.parent.username}}/followers/">{{counters.followers}} seguidores.</a>
                <a href="/fb/user/{{profile.parent.username}}/followings/">{{counters.followings}} siguiendo.</a>
            </p>
            <p>
                <span>También está en:</span>
                {% if profile.sociallinks.facebook %}
                    <a href="{{profile.sociallinks.facebook}}" id="facebook-icon">Facebook</a>
                {% endif %}
                {% if profile.sociallinks.twitter %}
                    <a href="{{profile.sociallinks.twitter}}"  id="twitter-icon">Twitter</a>
                {% endif %}
                {% if profile.sociallinks.foursquare %}
                    <a href="{{profile.sociallinks.foursquare}}" id="foursquare-icon">Foursquare</a>
                {% endif %}
            </p>
        </div>
    </div>
    <ul id="tabMenu" class="clear">
		<li id="his_suggestions" class="active">Sugerencias ({{counters.suggested}})</li>
		<li id="his_votes">Valoraciones ({{counters.supported}})</li>
		<li id="his_lists">Listas</li>
	</ul>
    <span id="suggestion-list">
            
            <!-- ALL SUGGESTIONS -->
            <span id="his_suggestions_content" class="tab-content ">
                <p>Sus sugerencias</p>
            </span>
            <!-- END ALL SUGGESTIONS -->
            
            <!-- ALL SUGGESTIONS -->
            <span id="his_votes_content" class="tab-content hidden">
                <p>Sus valoraciones</p>
            </span>
            <!-- END ALL SUGGESTIONS -->
            
            <!-- ALL SUGGESTIONS -->
            <span id="his_lists_content" class="tab-content hidden">
                <p>Sus listas</p>
            </span>
            <!-- END ALL SUGGESTIONS -->
    </span>
    
    <script id="suggestionTemplate" type="text/x-jquery-tmpl">
        <div id="suggestion_${element.id}" class="suggestion">
            <span class="suggestionName">${element.name}</span>
            <span class="suggestionInLists">Lista ${element.id}</span>
        </div>
    </script>
{% endblock %}
