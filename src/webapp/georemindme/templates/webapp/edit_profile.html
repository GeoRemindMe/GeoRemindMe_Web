{% extends "webapp/base_registered.html" %}
{% load tags %}
{% load i18n %}

{% block title %}Datos personales{% endblock %}
{% block goBack %}{%endblock%}

{% block extra_js %}
    <script type="text/javascript" src="/static/webapp/js/jquery.tmpl.min.js"></script>
    <script type="text/javascript" src="/static/webapp/js/jquery.placeholder.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
        
            $('#editPass').one('click',function(){
                $('#editPass').empty();
                $("#passForm").tmpl( {} ).appendTo("#editPass");
                $("[type='password']").placeholder();
            })
        });
    </script>
{%endblock%}
{% block body %}
    <div id="edit-profile">
        
        
        <h1>Editar perfil</h1>
        <div class="section">
            <form method="post" action="." id="editForm">
                <div id="avatar">
                    <span>
                        <img src="{% embedded_avatar user.username %}" alt="{{user.username}} avatar">
    <!--
                        <br>
                        Cambiar foto
    -->
                    </span> 
                    <div>
                        Usar el avatar de:<br>
                        <select id="id_user_set_profile-sync_avatar_with" name="user_set_profile-sync_avatar_with">
                            {% if user.facebook_user %}
                                <option value="facebook" {% if user.profile.sync_avatar_with = "facebook" %} selected="selected"{% endif %}>Facebook</option>
                            {% endif%}
                            {% if user.twitter_user %}
                                <option value="twitter" {% if user.profile.sync_avatar_with = "twitter" %} selected="selected"{% endif %}>Twitter</option>
                            {% endif %}
                            <option {% if user.profile.sync_avatar_with = "gravatar" %} selected="selected"{% endif %} value="gravatar">Gravatar</option>
                        </select>    
                    </div>
                </div>          
            
				{% csrf_token %}
				<dl>
					<dt><label for="id_user_set_profile-username">Nombre de usuario</label>:</dt>
					<dd>{{form.username}}</dd>
                    <span class="error-msg">{{form.errors.username}}</span>
					
					<dt>Password:</dt>
					<dd><span id="editPass" class="hoverlink">Editar password</span></dd>
					
					<dt><label for="id_user_set_profile-email">Email</label>:</dt>
					<dd>
                        <input type="text" name="user_set_profile-email" value="{{request.user.email}}" id="id_user_set_profile-email" readonly>
                    </dd>
                    <span class="error-msg">{{form.errors.email}}</span>
					
					<dt><label for="id_user_set_profile-description">Descripci칩n</label>:</dt>
					<dd>{{form.description}}</dd>
                    <span class="error-msg">{{form.errors.description}}</span>
					
				</dl>
                <hr>
				<div id="save-button">
                    <input type="submit" value="{% trans 'Guardar' %}" title="{% trans 'Guardar los cambios' %}">
                </div>
			</form>
        </div>
    </div>

<script id="passForm" type="text/x-jquery-tmpl">
<div id="passForm2">
    <input type="password" name="user_set_profile-old_password" id="old_pass" placeholder="Antigua contrase침a"/>
    {{form.errors.old_password}}
    <input type="password" name="user_set_profile-password" id="pass1" placeholder="Nueva contrase침a"/>
    {{form.errors.password1}}
    <input type="password" name="user_set_profile-password2" id="pass2" placeholder="Repite la contrase침a"/>
    {{form.errors.password2}}
</div>
</script>
    
{% endblock %}
